var U=(r,s,t)=>new Promise((o,n)=>{var i=c=>{try{p(t.next(c))}catch(g){n(g)}},v=c=>{try{p(t.throw(c))}catch(g){n(g)}},p=c=>c.done?o(c.value):Promise.resolve(c.value).then(i,v);p((t=t.apply(r,s)).next())});import{aw as I,ax as z,ay as R,az as E,aA as k,G as H}from"./bootstrap-DWRgxUs4.js";import{x as l,a4 as M,P as f,bk as m,av as C,ab as _,b2 as $,aB as a,a7 as b,ac as d,aq as j,ai as h,aj as D,aa as S}from"../jse/index-index-CnMwTtSj.js";var F={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M518.3 459a8 8 0 00-12.6 0l-112 141.7a7.98 7.98 0 006.3 12.9h73.9V856c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V613.7H624c6.7 0 10.4-7.7 6.3-12.9L518.3 459z"}},{tag:"path",attrs:{d:"M811.4 366.7C765.6 245.9 648.9 160 512.2 160S258.8 245.8 213 366.6C127.3 389.1 64 467.2 64 560c0 110.5 89.5 200 199.9 200H304c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8h-40.1c-33.7 0-65.4-13.4-89-37.7-23.5-24.2-36-56.8-34.9-90.6.9-26.4 9.9-51.2 26.2-72.1 16.7-21.3 40.1-36.8 66.1-43.7l37.9-9.9 13.9-36.6c8.6-22.8 20.6-44.1 35.7-63.4a245.6 245.6 0 0152.4-49.9c41.1-28.9 89.5-44.2 140-44.2s98.9 15.3 140 44.2c19.9 14 37.5 30.8 52.4 49.9 15.1 19.3 27.1 40.7 35.7 63.4l13.8 36.5 37.8 10C846.1 454.5 884 503.8 884 560c0 33.1-12.9 64.3-36.3 87.7a123.07 123.07 0 01-87.6 36.3H720c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h40.1C870.5 760 960 670.5 960 560c0-92.7-63.1-170.7-148.6-193.3z"}}]},name:"cloud-upload",theme:"outlined"};function N(r){for(var s=1;s<arguments.length;s++){var t=arguments[s]!=null?Object(arguments[s]):{},o=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(o=o.concat(Object.getOwnPropertySymbols(t).filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),o.forEach(function(n){q(r,n,t[n])})}return r}function q(r,s,t){return s in r?Object.defineProperty(r,s,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[s]=t,r}var O=function(s,t){var o=N({},s,t.attrs);return l(I,N({},o,{icon:F}),null)};O.displayName="CloudUploadOutlined";O.inheritAttrs=!1;const A={"data-title":"word项目方案生成器","data-description":"智能word项目方案生成器，一键生成专业项目文档"},G={class:"main-content"},J={class:"header-section"},Q={class:"title-container"},W={class:"input-section"},X={class:"input-group"},Y={for:"projectcode",class:"input-label"},Z={class:"action-buttons"},K={key:0,class:"progress-section"},ee={key:1,class:"error-section"},ae={key:2,class:"result-section"},te={class:"features-section"},se=M({__name:"index",setup(r){const s=f(""),t=f(!1),o=f(""),n=f(""),i=f(0),v=f(!1),p=f(!1),c=()=>U(null,null,function*(){if(!s.value.trim()){k.error("请输入项目编号");return}t.value=!0,p.value=!0,n.value="",o.value="",v.value=!1,i.value=0;const u=setInterval(()=>{i.value<90&&(i.value+=Math.random()*16,i.value>90&&(i.value=90))},300);try{const e=yield fetch("http://172.16.1.148:5000/api/generate-project-plan",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({project_code:s.value.trim()})});if(!e.ok)throw new Error(`HTTP ${e.status}`);const y=yield e.blob();o.value=URL.createObjectURL(y),i.value=100,k.success("项目方案生成成功！"),v.value=!0}catch(e){console.error(e),n.value="生成项目方案失败，请检查项目编号或网络连接",k.error("生成项目方案失败")}finally{clearInterval(u),t.value=!1,p.value=!1}}),g=()=>{if(!o.value)return;const u=document.createElement("a");u.href=o.value,u.download=`${s.value}_项目方案.docx`,document.body.appendChild(u),u.click(),document.body.removeChild(u),URL.revokeObjectURL(o.value),o.value="",v.value=!1,i.value=0},x=()=>{s.value="",n.value="",o.value="",v.value=!1,i.value=0};return(u,e)=>{const y=m("a-alert"),V=m("a-input"),w=m("a-button"),B=m("a-progress"),L=m("a-result"),P=m("a-card");return _(),C("div",A,[e[11]||(e[11]=$('<div class="animated-background" data-v-002112f4><div class="floating-shapes" data-v-002112f4><div class="shape shape-1" data-v-002112f4></div><div class="shape shape-2" data-v-002112f4></div><div class="shape shape-3" data-v-002112f4></div><div class="shape shape-4" data-v-002112f4></div></div></div>',1)),a("div",G,[a("div",J,[a("div",Q,[l(b(z),{class:"title-icon"}),e[1]||(e[1]=a("h1",{class:"main-title"},"智能项目方案生成器",-1)),e[2]||(e[2]=a("p",{class:"subtitle"},"基于ai技术的专业word文档自动生成工具",-1))])]),l(P,{class:"main-card",bordered:!1},{title:d(()=>[l(b(O),{class:"card-title-icon"}),e[3]||(e[3]=a("span",null,"生成项目方案",-1))]),default:d(()=>[a("div",W,[l(y,{message:"使用说明",description:"请输入有效的项目编号（如：25P1156），系统将自动查询数据库并生成专业的项目方案文档。",type:"info","show-icon":"",class:"usage-alert"}),a("div",X,[a("label",Y,[l(b(z),{class:"label-icon"}),e[4]||(e[4]=h(" 项目编号 "))]),l(V,{id:"projectcode",value:s.value,"onUpdate:value":e[0]||(e[0]=T=>s.value=T),placeholder:"请输入项目编号（例如：25P1156）",size:"large",disabled:t.value,class:"project-input","allow-clear":""},null,8,["value","disabled"])]),a("div",Z,[l(w,{type:"primary",size:"large",loading:t.value,disabled:!s.value.trim(),onClick:c,class:"generate-btn"},{icon:d(()=>[t.value?(_(),S(b(R),{key:1})):(_(),S(b(O),{key:0}))]),default:d(()=>[h(" "+D(t.value?"生成中...":"生成项目方案"),1)]),_:1},8,["loading","disabled"]),l(w,{size:"large",onClick:x,disabled:t.value,class:"reset-btn"},{default:d(()=>e[5]||(e[5]=[h(" 重置 ")])),_:1,__:[5]},8,["disabled"])]),p.value?(_(),C("div",K,[l(B,{percent:Math.round(i.value),"show-info":!0,"stroke-color":{"0%":"#108ee9","100%":"#87d068"},"stroke-linecap":"square"},null,8,["percent"]),e[6]||(e[6]=a("p",{class:"progress-text"},"正在生成项目方案，请稍候...",-1))])):j("",!0),n.value?(_(),C("div",ee,[l(y,{message:n.value,type:"error","show-icon":""},null,8,["message"])])):j("",!0),v.value?(_(),C("div",ae,[l(L,{status:"success",title:"项目方案生成成功！","sub-title":"您的项目方案文档已准备就绪，点击下方按钮即可下载。"},{extra:d(()=>[l(w,{type:"primary",size:"large",onClick:g,class:"download-btn"},{icon:d(()=>[l(b(E))]),default:d(()=>[e[7]||(e[7]=h(" 下载项目方案文档 "))]),_:1,__:[7]}),l(w,{size:"large",onClick:x,class:"new-doc-btn"},{default:d(()=>e[8]||(e[8]=[h(" 生成新文档 ")])),_:1,__:[8]})]),_:1})])):j("",!0)])]),_:1}),a("div",te,[l(P,{class:"feature-card",bordered:!1},{title:d(()=>e[9]||(e[9]=[a("span",null,"功能特性",-1)])),default:d(()=>[e[10]||(e[10]=a("div",{class:"features-grid"},[a("div",{class:"feature-item"},[a("div",{class:"feature-icon"},"🚀"),a("h4",null,"快速生成"),a("p",null,"一键生成专业项目方案文档，节省大量时间")]),a("div",{class:"feature-item"},[a("div",{class:"feature-icon"},"📊"),a("h4",null,"数据驱动"),a("p",null,"基于真实数据库信息，确保文档准确性")]),a("div",{class:"feature-item"},[a("div",{class:"feature-icon"},"🎨"),a("h4",null,"专业模板"),a("p",null,"使用标准化模板，文档格式规范美观")]),a("div",{class:"feature-item"},[a("div",{class:"feature-icon"},"🔒"),a("h4",null,"安全可靠"),a("p",null,"本地化处理，数据安全有保障")])],-1))]),_:1,__:[10]})])])])}}}),re=H(se,[["__scopeId","data-v-002112f4"]]);export{re as default};
